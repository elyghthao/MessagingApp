{"ast":null,"code":"import _slicedToArray from\"C:/Users/elygh/Desktop/MessagingApp_FullStack/MessagingApp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{motion}from'framer-motion';import{client,urlFor}from'../client';import pikachu from'../assets/pikachu.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Main(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),reload=_useState4[0],setReload=_useState4[1];var size=0;useEffect(function(){//called once whenthe site first loads\nvar query='*[_type == \"message\"]';client.fetch(query).then(function(data){size=data.length;// console.log(\"size is: \" + size);\nsetMessage(data);});},[]);useEffect(function(){setInterval(function(){var query='*[_type == \"message\"]';client.fetch(query).then(function(data){// console.log(data);\n// console.log(\"current size is: \" + size)\nif(size!=data.length){// console.log(\"change!\");\nsize=data.length;setMessage(data);}});},2000);},[]);message.sort(function(a,b){var keyA=new Date(a._createdAt),keyB=new Date(b._createdAt);// Compare the 2 dates\nif(keyA<keyB)return-1;if(keyA>keyB)return 1;return 0;});// message.sort();\n// console.log(message);\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"\\r bg-stone-200\\r w-screen\\r block\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-stone-200 p-5 w-full\"}),/*#__PURE__*/_jsx(\"div\",{children:message.map(function(msg,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"pt-5 px-10 rounded-1/8 bg-stone-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\\r bg-green-400\\r rounded-full\\r flex \\r justify-center items-center\\r \",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-medium\",children:msg.content})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center\",children:msg.img&&/*#__PURE__*/_jsx(\"img\",{src:urlFor(msg.img),alt:msg.timestamp,className:\"object-cover w-1/4 p-1 \".concat(index===message.length-1?'pt-1 pb-14':'')})})]},index);})})]});}export default Main;","map":{"version":3,"names":["React","useState","useEffect","motion","client","urlFor","pikachu","Main","message","setMessage","reload","setReload","size","query","fetch","then","data","length","setInterval","sort","a","b","keyA","Date","_createdAt","keyB","map","msg","index","content","img","timestamp"],"sources":["C:/Users/elygh/Desktop/MessagingApp_FullStack/MessagingApp/src/Components/Main.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { motion } from 'framer-motion';\r\nimport { client, urlFor } from '../client';\r\nimport pikachu from '../assets/pikachu.png'\r\n\r\n\r\nfunction Main() {\r\n  const [message, setMessage] = useState([]);\r\n  const [reload, setReload] = useState(0);\r\n  let size = 0;\r\n  useEffect(() => {//called once whenthe site first loads\r\n    const query = '*[_type == \"message\"]'\r\n    client.fetch(query).then((data) => { \r\n      size = data.length;\r\n      // console.log(\"size is: \" + size);\r\n      setMessage(data);\r\n    }\r\n    )\r\n  }, [])\r\n\r\n  useEffect(()=>{\r\n    setInterval(()=>{\r\n      const query = '*[_type == \"message\"]'\r\n      client.fetch(query).then((data) => { \r\n        // console.log(data);\r\n        // console.log(\"current size is: \" + size)\r\n        if(size != data.length){\r\n          // console.log(\"change!\");\r\n          size = data.length;\r\n          setMessage(data);\r\n        }})\r\n    }, 2000)\r\n  }, [])\r\n\r\n\r\n\r\n\r\n    \r\n\r\n  message.sort(function(a, b) {\r\n    var keyA = new Date(a._createdAt),\r\n      keyB = new Date(b._createdAt);\r\n    // Compare the 2 dates\r\n    if (keyA < keyB) return -1;\r\n    if (keyA > keyB) return 1;\r\n    return 0;\r\n  });\r\n\r\n\r\n  // message.sort();\r\n  // console.log(message);\r\n  return (\r\n    <div className=\"\r\n    bg-stone-200\r\n      w-screen\r\n      block\">\r\n      {/* <h1 className=''>Main</h1> */}\r\n      <div className='bg-stone-200 p-5 w-full'></div>\r\n\r\n\r\n      <div>\r\n        {message.map((msg, index) => (\r\n          <div className='pt-5 px-10 rounded-1/8 bg-stone-200' key={index}>\r\n            <div className='\r\n              bg-green-400\r\n              rounded-full\r\n              flex \r\n              justify-center items-center\r\n              '>\r\n              <h1 className='text-2xl font-medium'>{msg.content}</h1>\r\n            </div>\r\n\r\n            <div className='flex justify-center items-center'>\r\n               {msg.img && \r\n               <img src={urlFor(msg.img)} alt={msg.timestamp} className=\r\n               {`object-cover w-1/4 p-1 ${(index === message.length-1) ? 'pt-1 pb-14': ''}`} />\r\n               }\r\n            </div>\r\n\r\n            \r\n            {/* <img src={pikachu} alt={msg.timestamp} className=\r\n               {`object-scale-down h-48 w-96`} /> */}\r\n            \r\n\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Main;"],"mappings":"gJAAA,MAAOA,MAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,MAAM,KAAQ,eAAe,CACtC,OAASC,MAAM,CAAEC,MAAM,KAAQ,WAAW,CAC1C,MAAOC,QAAO,KAAM,uBAAuB,yFAG3C,QAASC,KAAI,EAAG,CACd,cAA8BN,QAAQ,CAAC,EAAE,CAAC,wCAAnCO,OAAO,eAAEC,UAAU,eAC1B,eAA4BR,QAAQ,CAAC,CAAC,CAAC,yCAAhCS,MAAM,eAAEC,SAAS,eACxB,GAAIC,KAAI,CAAG,CAAC,CACZV,SAAS,CAAC,UAAM,CAAC;AACf,GAAMW,MAAK,CAAG,uBAAuB,CACrCT,MAAM,CAACU,KAAK,CAACD,KAAK,CAAC,CAACE,IAAI,CAAC,SAACC,IAAI,CAAK,CACjCJ,IAAI,CAAGI,IAAI,CAACC,MAAM,CAClB;AACAR,UAAU,CAACO,IAAI,CAAC,CAClB,CAAC,CACA,CACH,CAAC,CAAE,EAAE,CAAC,CAENd,SAAS,CAAC,UAAI,CACZgB,WAAW,CAAC,UAAI,CACd,GAAML,MAAK,CAAG,uBAAuB,CACrCT,MAAM,CAACU,KAAK,CAACD,KAAK,CAAC,CAACE,IAAI,CAAC,SAACC,IAAI,CAAK,CACjC;AACA;AACA,GAAGJ,IAAI,EAAII,IAAI,CAACC,MAAM,CAAC,CACrB;AACAL,IAAI,CAAGI,IAAI,CAACC,MAAM,CAClBR,UAAU,CAACO,IAAI,CAAC,CAClB,CAAC,CAAC,CAAC,CACP,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAAE,EAAE,CAAC,CAONR,OAAO,CAACW,IAAI,CAAC,SAASC,CAAC,CAAEC,CAAC,CAAE,CAC1B,GAAIC,KAAI,CAAG,GAAIC,KAAI,CAACH,CAAC,CAACI,UAAU,CAAC,CAC/BC,IAAI,CAAG,GAAIF,KAAI,CAACF,CAAC,CAACG,UAAU,CAAC,CAC/B;AACA,GAAIF,IAAI,CAAGG,IAAI,CAAE,MAAO,CAAC,CAAC,CAC1B,GAAIH,IAAI,CAAGG,IAAI,CAAE,MAAO,EAAC,CACzB,MAAO,EAAC,CACV,CAAC,CAAC,CAGF;AACA;AACA,mBACE,aAAK,SAAS,CAAC,oCAGP,wBAEN,YAAK,SAAS,CAAC,yBAAyB,EAAO,cAG/C,qBACGjB,OAAO,CAACkB,GAAG,CAAC,SAACC,GAAG,CAAEC,KAAK,qBACtB,aAAK,SAAS,CAAC,qCAAqC,wBAClD,YAAK,SAAS,CAAC,yEAKZ,uBACD,WAAI,SAAS,CAAC,sBAAsB,UAAED,GAAG,CAACE,OAAO,EAAM,EACnD,cAEN,YAAK,SAAS,CAAC,kCAAkC,UAC7CF,GAAG,CAACG,GAAG,eACR,YAAK,GAAG,CAAEzB,MAAM,CAACsB,GAAG,CAACG,GAAG,CAAE,CAAC,GAAG,CAAEH,GAAG,CAACI,SAAU,CAAC,SAAS,kCAC5BH,KAAK,GAAKpB,OAAO,CAACS,MAAM,CAAC,CAAC,CAAI,YAAY,CAAE,EAAE,CAAG,EAAG,EAE7E,GAfkDW,KAAK,CAsBzD,EACP,CAAC,EACE,GAGF,CAEV,CAEA,cAAerB,KAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}